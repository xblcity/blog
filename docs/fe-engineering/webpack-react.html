<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用 webpack 从零配置 React 开发环境及打包优化 | Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/avatar.png">
    <meta name="description" content="小白龙的前端记录">
    
    <link rel="preload" href="/assets/css/0.styles.877ae807.css" as="style"><link rel="preload" href="/assets/js/app.68d59ecc.js" as="script"><link rel="preload" href="/assets/js/2.f4862a58.js" as="script"><link rel="preload" href="/assets/js/4.decbb015.js" as="script"><link rel="prefetch" href="/assets/js/10.c8623457.js"><link rel="prefetch" href="/assets/js/11.a83d8484.js"><link rel="prefetch" href="/assets/js/12.05f390b2.js"><link rel="prefetch" href="/assets/js/13.16ead135.js"><link rel="prefetch" href="/assets/js/14.331b18ce.js"><link rel="prefetch" href="/assets/js/15.473bdbc5.js"><link rel="prefetch" href="/assets/js/16.e2e606f7.js"><link rel="prefetch" href="/assets/js/17.e1aac6b7.js"><link rel="prefetch" href="/assets/js/18.b7b840c3.js"><link rel="prefetch" href="/assets/js/19.da5ffe91.js"><link rel="prefetch" href="/assets/js/20.a9bd596a.js"><link rel="prefetch" href="/assets/js/21.59579a86.js"><link rel="prefetch" href="/assets/js/22.7abbe3ec.js"><link rel="prefetch" href="/assets/js/23.91f0e469.js"><link rel="prefetch" href="/assets/js/24.f12edf3b.js"><link rel="prefetch" href="/assets/js/25.a2b6a6d6.js"><link rel="prefetch" href="/assets/js/26.96e0f7fb.js"><link rel="prefetch" href="/assets/js/27.d33b415f.js"><link rel="prefetch" href="/assets/js/28.f0325283.js"><link rel="prefetch" href="/assets/js/29.3a41580a.js"><link rel="prefetch" href="/assets/js/3.84de1c12.js"><link rel="prefetch" href="/assets/js/30.f864d989.js"><link rel="prefetch" href="/assets/js/31.028cbe67.js"><link rel="prefetch" href="/assets/js/32.6895e161.js"><link rel="prefetch" href="/assets/js/33.f8a2bec6.js"><link rel="prefetch" href="/assets/js/34.911cdc3b.js"><link rel="prefetch" href="/assets/js/35.311fed49.js"><link rel="prefetch" href="/assets/js/36.524996bc.js"><link rel="prefetch" href="/assets/js/37.3d714043.js"><link rel="prefetch" href="/assets/js/38.c1cc7f96.js"><link rel="prefetch" href="/assets/js/39.8491a725.js"><link rel="prefetch" href="/assets/js/40.9e81dc98.js"><link rel="prefetch" href="/assets/js/41.16b676f9.js"><link rel="prefetch" href="/assets/js/42.00d1b7e2.js"><link rel="prefetch" href="/assets/js/43.726b8471.js"><link rel="prefetch" href="/assets/js/44.ac91b073.js"><link rel="prefetch" href="/assets/js/45.32f36537.js"><link rel="prefetch" href="/assets/js/46.fb818679.js"><link rel="prefetch" href="/assets/js/47.2804bd02.js"><link rel="prefetch" href="/assets/js/48.4fccd1e8.js"><link rel="prefetch" href="/assets/js/49.2920847a.js"><link rel="prefetch" href="/assets/js/5.e2025a9c.js"><link rel="prefetch" href="/assets/js/50.b8a4d984.js"><link rel="prefetch" href="/assets/js/51.55b8f4c5.js"><link rel="prefetch" href="/assets/js/52.879cc2d6.js"><link rel="prefetch" href="/assets/js/53.86d2a99f.js"><link rel="prefetch" href="/assets/js/54.a5bcaa15.js"><link rel="prefetch" href="/assets/js/55.34be4b83.js"><link rel="prefetch" href="/assets/js/56.7be6c423.js"><link rel="prefetch" href="/assets/js/57.748041f0.js"><link rel="prefetch" href="/assets/js/58.de5c0f0c.js"><link rel="prefetch" href="/assets/js/59.bf043c37.js"><link rel="prefetch" href="/assets/js/6.56190a97.js"><link rel="prefetch" href="/assets/js/60.6586a819.js"><link rel="prefetch" href="/assets/js/61.c5de2c6b.js"><link rel="prefetch" href="/assets/js/62.96191d68.js"><link rel="prefetch" href="/assets/js/7.25e7c10d.js"><link rel="prefetch" href="/assets/js/8.5a9bb928.js"><link rel="prefetch" href="/assets/js/9.3e1487c6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.877ae807.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avatar.png" alt="Blog" class="logo"> <span class="site-name can-hide">Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://reading.xblcity.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  读书笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/xblcity" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://blogc.xblcity.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客搭建
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://reading.xblcity.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  读书笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/xblcity" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://blogc.xblcity.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客搭建
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">介绍</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JS基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js-base/summary.html" class="sidebar-link">前端知识体系</a></li><li><a href="/js-base/this.html" class="sidebar-link">理解this</a></li><li><a href="/js-base/call.html" class="sidebar-link">call, apply, bind手动实现</a></li><li><a href="/js-base/scope-closures.html" class="sidebar-link">作用域与闭包</a></li><li><a href="/js-base/copy.html" class="sidebar-link">赋值与深浅拷贝</a></li><li><a href="/js-base/inherit.html" class="sidebar-link">类与继承</a></li><li><a href="/js-base/object-methods.html" class="sidebar-link">Object 构造器及原型上的方法</a></li><li><a href="/js-base/eventloop.html" class="sidebar-link">JS 事件队列/循环(Event Loop)</a></li><li><a href="/js-base/es6.html" class="sidebar-link">ES6 知识点</a></li><li><a href="/js-base/ajax.html" class="sidebar-link">AJAX</a></li><li><a href="/js-base/func-program.html" class="sidebar-link">高阶函数</a></li><li><a href="/js-base/design-mode.html" class="sidebar-link">JS 设计模式</a></li><li><a href="/js-base/algorithm.html" class="sidebar-link">数据结构与算法</a></li><li><a href="/js-base/ts-basic.html" class="sidebar-link">Typescript 认知</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JS应用</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js-practice/throttle.html" class="sidebar-link">理解节流与防抖函数</a></li><li><a href="/js-practice/array.html" class="sidebar-link">数组的数据处理</a></li><li><a href="/js-practice/utils.html" class="sidebar-link">JS 常用工具函数/代码片段</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>框架及实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/lifecycle.html" class="sidebar-link">React 生命周期总结&amp;应用</a></li><li><a href="/react/react-hooks.html" class="sidebar-link">React-Hooks 总结&amp;实践</a></li><li><a href="/react/react-ts.html" class="sidebar-link">在 React 中使用 TS</a></li><li><a href="/react/redux.html" class="sidebar-link">Redux/React-Redux</a></li><li><a href="/react/redux-middleware.html" class="sidebar-link">Redux 中间件</a></li><li><a href="/react/find-house.html" class="sidebar-link">找房筛选条件表单封装</a></li><li><a href="/library/wx-web.html" class="sidebar-link">微信公众号网页登录与支付</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端综合知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fe-system/performance.html" class="sidebar-link">性能优化</a></li><li><a href="/fe-system/render.html" class="sidebar-link">从输入网址到页面渲染经历了什么</a></li><li><a href="/fe-system/http.html" class="sidebar-link">http 知识体系</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fe-engineering/webpack-react.html" aria-current="page" class="active sidebar-link">使用 webpack 从零配置 React 开发环境及打包优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-实现对-jsx-js-png-less-等文件进行打包" class="sidebar-link">1.实现对 JSX, JS, PNG, LESS 等文件进行打包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-1-初始化" class="sidebar-link">1.1 初始化</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-2-安装-webpack" class="sidebar-link">1.2 安装 webpack</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-3-安装样式相关-loader" class="sidebar-link">1.3 安装样式相关 loader</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-4-安装-babel-react-相关-loader-安装-react-相关依赖" class="sidebar-link">1.4 安装 babel,react 相关 loader，安装 react 相关依赖</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-5-安装图片处理相关-loader" class="sidebar-link">1.5 安装图片处理相关 loader</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-6-项目目录结构" class="sidebar-link">1.6 项目目录结构</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-7-踩坑点" class="sidebar-link">1.7 踩坑点</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_1-8-进行打包" class="sidebar-link">1.8 进行打包</a></li></ul></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_2-配置-ts-以及-dev-环境" class="sidebar-link">2. 配置 ts 以及 dev 环境</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_2-1-配置-ts-开发环境" class="sidebar-link">2.1 配置 ts 开发环境</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_2-2-配置-dev-环境" class="sidebar-link">2.2 配置 dev 环境</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_2-3-优化-react-ts-使用体验" class="sidebar-link">2.3 优化 react-ts 使用体验</a></li></ul></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_3-优化" class="sidebar-link">3.优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#针对包的大小进行优化实践" class="sidebar-link">针对包的大小进行优化实践</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#其他优化" class="sidebar-link">其他优化</a></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#_3-43-踩坑" class="sidebar-link">3.43 踩坑</a></li></ul></li><li class="sidebar-sub-header"><a href="/fe-engineering/webpack-react.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/fe-engineering/webpack.html" class="sidebar-link">webpack 配置及优化</a></li><li><a href="/fe-engineering/vs.html" class="sidebar-link">vscode 插件与配置</a></li><li><a href="/fe-engineering/git.html" class="sidebar-link">git 的使用</a></li><li><a href="/fe-engineering/git-account.html" class="sidebar-link">Git 多账号配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>后端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/backend/little-points.html" class="sidebar-link">node 知识点</a></li><li><a href="/backend/blog.html" class="sidebar-link">博客的后端实现</a></li><li><a href="/backend/mysql.html" class="sidebar-link">mysql 使用</a></li><li><a href="/backend/server.html" class="sidebar-link">使用服务器</a></li><li><a href="/backend/nginx.html" class="sidebar-link">nginx 在 window 下的配置与使用</a></li><li><a href="/backend/ubuntu.html" class="sidebar-link">ubuntu服务器终端及图形界面连接</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="使用-webpack-从零配置-react-开发环境及打包优化"><a href="#使用-webpack-从零配置-react-开发环境及打包优化" class="header-anchor">#</a> 使用 webpack 从零配置 React 开发环境及打包优化</h1> <p>使用的 webpack 版本是@4.39.3，不过@5 beta 版已经发布了，emmmm...</p> <h2 id="_1-实现对-jsx-js-png-less-等文件进行打包"><a href="#_1-实现对-jsx-js-png-less-等文件进行打包" class="header-anchor">#</a> 1.实现对 JSX, JS, PNG, LESS 等文件进行打包</h2> <p>目标：将 JSX, LESS 等文件进行打包成 bundle.js，在 HMTL 中引入并可以在浏览器访问</p> <p><a href="https://github.com/xblcity/web-learning/tree/master/webpack-learn/first" target="_blank" rel="noopener noreferrer">源码地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_1-1-初始化"><a href="#_1-1-初始化" class="header-anchor">#</a> 1.1 初始化</h3> <ul><li><p>新建 first 文件夹</p></li> <li><p>在文件夹中使用<code>npm init -y</code>生成<code>package.json</code>文件</p></li></ul> <h3 id="_1-2-安装-webpack"><a href="#_1-2-安装-webpack" class="header-anchor">#</a> 1.2 安装 webpack</h3> <p>使用<code>npm</code>或者<code>yarn</code>安装下面依赖，本文全部使用的<code>yarn</code></p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add webpack webpack<span class="token operator">-</span>cli <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><blockquote><p>注释: webpack-cli 是 webpack 的命令行工具 -D 是 --save--dev 的缩写， -S 是 --save 的缩写。版本号：webpack@4.39.3，webpack-cli@3.3.7</p></blockquote> <h3 id="_1-3-安装样式相关-loader"><a href="#_1-3-安装样式相关-loader" class="header-anchor">#</a> 1.3 安装样式相关 loader</h3> <div class="language-js extra-class"><pre class="language-js"><code>yarn add css<span class="token operator">-</span>loader style<span class="token operator">-</span>loader less less<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><blockquote><p>注释: css-loader 可以配置 css-module，css-loader 用于处理.css 文件，style-loader 用于把样式插入 dom</p></blockquote> <h3 id="_1-4-安装-babel-react-相关-loader-安装-react-相关依赖"><a href="#_1-4-安装-babel-react-相关-loader-安装-react-相关依赖" class="header-anchor">#</a> 1.4 安装 babel,react 相关 loader，安装 react 相关依赖</h3> <p>安装 babel</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add babel<span class="token operator">-</span>loader @babel<span class="token operator">/</span>core @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><blockquote><p>注释: babel，将 es6 转换为 es5，@babel/core 是 babel-core 的第七版，@babel/preset-env 是 babel-preset-env 升级版，用于配置浏览器的兼容度以及使用最新 ES6 语法。不需要安装 babel-preset-stage-0，因为 preset-env 已经集成了这几个 stage 的功能。但是 preset-env 不支持修饰器，动态引入，静态属性等等 ES6+ 最新的语法</p></blockquote> <p>安装 babel-react</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add @babel<span class="token operator">/</span>preset<span class="token operator">-</span>react <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><blockquote><p>注释: @babel/preset-react 是 babel-preset-react 升级版, 用于将 jsx 转换成 js</p></blockquote> <p>安装 react 相关依赖</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add react react<span class="token operator">-</span>dom <span class="token operator">-</span><span class="token constant">S</span>
</code></pre></div><blockquote><p>注释, babel 转换主要使用到的是 React.createElement()方法</p></blockquote> <h3 id="_1-5-安装图片处理相关-loader"><a href="#_1-5-安装图片处理相关-loader" class="header-anchor">#</a> 1.5 安装图片处理相关 loader</h3> <div class="language-js extra-class"><pre class="language-js"><code>yarn add url<span class="token operator">-</span>loader file<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><h3 id="_1-6-项目目录结构"><a href="#_1-6-项目目录结构" class="header-anchor">#</a> 1.6 项目目录结构</h3> <p>新建配置文件及开发文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span> dist <span class="token comment">// 用于存放打包后的文件</span>
<span class="token operator">--</span> node_modules <span class="token comment">// 依赖包，自动生成</span>
<span class="token operator">--</span> webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js <span class="token comment">// webpack配置</span>
<span class="token operator">--</span> <span class="token punctuation">.</span>babelrc <span class="token comment">// babel配置</span>
<span class="token operator">--</span> src
  <span class="token operator">--</span> assets
    <span class="token operator">--</span> avatar<span class="token punctuation">.</span>png
  <span class="token operator">--</span> index<span class="token punctuation">.</span>jsx
  <span class="token operator">--</span> app<span class="token punctuation">.</span>jsx
  <span class="token operator">--</span> app<span class="token punctuation">.</span>less
  <span class="token operator">--</span> index<span class="token punctuation">.</span>html
<span class="token operator">--</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json
<span class="token operator">--</span> <span class="token punctuation">.</span>gitignore <span class="token comment">// 设置git忽略文件</span>
</code></pre></div><p>可以按照这个顺序对文件进行配置与修改 <code>src/app.js</code> 以及 <code>src/app.less</code> ---&gt; <code>src/index.jsx</code> ---&gt; <code>webpack.config.js</code> ---&gt; <code>.babelrc</code></p> <p>贴一下主要文件的内容</p> <p><img src="/assets/img/webpack1_1.b3724998.png" alt="webpack"></p> <p><img src="/assets/img/webpack1_2.8cd8bae2.png" alt="webpack"></p> <p><img src="data:image/png;base64,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" alt="webpack"></p> <p><img src="/assets/img/webpack1_4.250ea166.png" alt="webpack"></p> <p><img src="/assets/img/webpack1_5.caa74f2d.png" alt="webpack"></p> <p>关于 webpack 的一些配置，可以参考<a href="https://github.com/xblcity/blog/blob/master/fe-engineering/webpack.md" target="_blank" rel="noopener noreferrer">上一篇的内容<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_1-7-踩坑点"><a href="#_1-7-踩坑点" class="header-anchor">#</a> 1.7 踩坑点</h3> <ul><li>webpack 配置文件需要使用 Common.js 模块规范(因为是 node 可执行文件)，ES6 模块语法无法使用，但是其他文件如 app.js 可以使用 ES6 语法(因为有 babel-loader 可以进行转换)</li> <li><code>index.tsx</code>，<code>ReactDOM.render(element, document.getElementById('app'))</code>要与<code>HTML</code>的节点<code>id</code>对应，其次,引入的<code>import ReactDOM from 'react-dom'</code>名字是不做严格区分的</li> <li>构建完成的 script 文件要放在 id 为 app 的 div 下面</li></ul> <h4 id="webpack-配置文件容易出错的部分"><a href="#webpack-配置文件容易出错的部分" class="header-anchor">#</a> webpack 配置文件容易出错的部分</h4> <ul><li>webpack 容易写错的部分，output 的是 filename 以及 path，不是 pathname</li> <li>webpack module rules 里面书写的是 loader 的规则</li> <li>注意：rules 之下的规则，test 后面跟正则表达式，而不是加引号的字符串</li> <li>添加 mode，让 webpack 打包时进行相应的优化</li></ul> <h4 id="与-react-配置有关的注意事项"><a href="#与-react-配置有关的注意事项" class="header-anchor">#</a> 与 react 配置有关的注意事项</h4> <ul><li>如果使用了 babel-loader 处理包含 jsx 语法的 js 文件，最好配置.babelrc(rc 可以解为 resource 缩写)里面的 presets 配置项，preset-react，preset-env 可以配置要兼容浏览器支持语法的程度。当然，.babelrc 也可以配置 plugins 选项，这里并没有用到</li></ul> <h3 id="_1-8-进行打包"><a href="#_1-8-进行打包" class="header-anchor">#</a> 1.8 进行打包</h3> <p>在<code>package.json</code>文件的<code>script</code>中添加 <code>build</code> 命令即可。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config webpack.config.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>命令行输入<code>yarn build</code>，可以看到在<code>build</code>目录多出了一个<code>bundle.js</code>文件，把<code>src</code>目录下的<code>index.html</code>在浏览器中打开，就可以看到我们实现的页面了</p> <p><img src="/assets/img/webpack1_6.d43a8219.png" alt="打包成功"></p> <h2 id="_2-配置-ts-以及-dev-环境"><a href="#_2-配置-ts-以及-dev-环境" class="header-anchor">#</a> 2. 配置 ts 以及 dev 环境</h2> <h3 id="_2-1-配置-ts-开发环境"><a href="#_2-1-配置-ts-开发环境" class="header-anchor">#</a> 2.1 配置 ts 开发环境</h3> <p>在此之前，我们先配置一下 ts-react 开发环境。</p> <p>新建目录 second，全局安装<code>typescript</code>，目的是为了能够使用<code>tsc</code>命令</p> <p>分别执行以下命令</p> <div class="language-js extra-class"><pre class="language-js"><code>npm init <span class="token operator">-</span>y <span class="token comment">// 生成package.json</span>
tsc <span class="token operator">--</span>init <span class="token comment">// 生成tsconfig.json</span>
</code></pre></div><p>按照上一节的内容安装依赖</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add webpack webpack<span class="token operator">-</span>cli css<span class="token operator">-</span>loader style<span class="token operator">-</span>loader less less<span class="token operator">-</span>loader babel<span class="token operator">-</span>loader @babel<span class="token operator">/</span>core @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env @babel<span class="token operator">/</span>preset<span class="token operator">-</span>react url<span class="token operator">-</span>loader file<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>

yarn add react react<span class="token operator">-</span>dom <span class="token operator">-</span><span class="token constant">S</span>
</code></pre></div><p>安装项目需要的 typescript 相关依赖，以及 react type 库</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add typescript @babel<span class="token operator">/</span>preset<span class="token operator">-</span>typescript <span class="token operator">-</span><span class="token constant">D</span>
yarn add @types<span class="token operator">/</span>react<span class="token operator">-</span>dom @types<span class="token operator">/</span>react <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><blockquote><p>注释：types 依赖包含.d.ts 声明文件，在 react 中用 TS 语法时，会自动对变量进行类型检测</p></blockquote> <p>因为要区分开发环境与正式环境的 webpack 配置，这里我们新建<code>base dev prod</code>等三个文件对 webpack 进行配置</p> <p>文件目录</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span> dist <span class="token comment">// 用于存放打包后的文件</span>
<span class="token operator">--</span> node_modules <span class="token comment">// 依赖包，自动生成</span>
<span class="token operator">--</span> webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>base<span class="token punctuation">.</span>js <span class="token comment">// webpack基础配置</span>
<span class="token operator">--</span> webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js <span class="token comment">// webpack开发环境配置</span>
<span class="token operator">--</span> webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js <span class="token comment">// webpack正式环境配置</span>
<span class="token operator">--</span> <span class="token punctuation">.</span>babelrc <span class="token comment">// babel配置</span>
<span class="token operator">--</span> src
  <span class="token operator">--</span> assets
    <span class="token operator">--</span> avatar<span class="token punctuation">.</span>png
  <span class="token operator">--</span> index<span class="token punctuation">.</span>tsx
  <span class="token operator">--</span> app<span class="token punctuation">.</span>tsx
  <span class="token operator">--</span> app<span class="token punctuation">.</span>less
  <span class="token operator">--</span> index<span class="token punctuation">.</span>html
<span class="token operator">--</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json
<span class="token operator">--</span> tsconfig<span class="token punctuation">.</span>json
<span class="token operator">--</span> <span class="token punctuation">.</span>gitignore <span class="token comment">// 设置git忽略文件</span>
</code></pre></div><p>当我们按照上一节的内容把<code>index.tsx app.tsx app.less</code>几个文件写好后，发现多处报红，我们需要把<code>tsconfig.json</code>文件的<code>jsx</code>选项的值改成<code>react</code>并取消注释。</p> <p><img src="/assets/img/ts2.a406e531.png" alt="ts"></p> <p>关于 JSX 部分的代码不报红了，但是引入的 less 文件，png 文件报红了，为什么呢？是因为 TS 没有找到这两个文件对应的<code>.d.ts</code>声明文件，那应该如何解决？</p> <p><img src="/assets/img/ts1.75e70ee2.png" alt="ts"></p> <p>可以自己写一个<code>.d.ts</code>文件对 png 以及 less 文件进行 intrface 定义，或者是安装依赖包进行自动生成，这里举例第一种方法</p> <p>src 目录下新建<code>globalType.d.ts</code></p> <div class="language-js extra-class"><pre class="language-js"><code>declare module <span class="token string">'*.less'</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> content<span class="token operator">:</span> any
  <span class="token keyword">export</span> <span class="token operator">=</span> content
<span class="token punctuation">}</span>

declare module <span class="token string">'*.png'</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> content<span class="token operator">:</span> any
  <span class="token keyword">export</span> <span class="token operator">=</span> content
<span class="token punctuation">}</span>
</code></pre></div><p>这时候就没有红色警告啦~</p> <p>但是还有一个问题，在<code>index.tsx</code>中，引入的<code>app.tsx</code>报红，但是把<code>.tsx</code>去掉<code>webpack</code>会找不到<code>app</code>文件而打包失败，这时候我们需要配置<code>webpack</code>的<code>resolve</code>配置项</p> <p><img src="/assets/img/ts3.a7ffe9b4.png" alt="ts"></p> <div class="language-js extra-class"><pre class="language-js"><code>resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 省略文件后缀，让webpack自动查找</span>
  extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.tsx'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>好了，页面终于没警告了~</p> <p>紧接着配置<code>.babelrc</code>，其实主要就是多添加一个<code>@babel/preset-typescript</code> 的 <code>presets</code></p> <p>配置 webpack，安装依赖</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add webpack<span class="token operator">-</span>merge <span class="token operator">-</span><span class="token constant">D</span> <span class="token comment">// 该依赖可以合并webpack配置</span>
</code></pre></div><p>紧接着配置<code>webpack.config.base.js</code>以及<code>webpack.config.dev.js</code>，详细见<a href="https://github.com/xblcity/web-learning/tree/master/webpack-learn/second" target="_blank" rel="noopener noreferrer">源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>最后在<code>package.json</code>文件添加<code>build</code>命令<code>&quot;build&quot;: &quot;webpack --config webpack.config.prod.js&quot;</code>并执行</p> <p><img src="/assets/img/ts4.415205f8.png" alt="ts"></p> <p>显示打包文件过大，因为<code>less png</code>等文件也被打包成 js 文件了，这里暂时先放着，后面会进行优化</p> <p>在<code>index.html</code>中引入<code>bundle.js</code>,在浏览器打开，发现加载成功</p> <h3 id="_2-2-配置-dev-环境"><a href="#_2-2-配置-dev-环境" class="header-anchor">#</a> 2.2 配置 dev 环境</h3> <p>如果每次改变一个文件，都要输入打包命令再去浏览器里面查看应用，开发会变得很麻烦，在开发环境下，我们可以使用基于 express 的 webpack 提供 webpack-dev-server，帮助我们更好的在开发环境中开发。</p> <p>在此之前，我们需要安装两个插件，做到动态生成 <code>bundle</code> 以及 <code>index.html</code> 文件</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add html<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin clean<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">-</span><span class="token constant">D</span> <span class="token comment">// 每次生成新的html以及清理html</span>
yarn add webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server <span class="token operator">-</span><span class="token constant">D</span> <span class="token comment">// devServer服务</span>
</code></pre></div><p>把<code>src/index.html</code> <code>&lt;script src=&quot;../dist/bundle.js&quot;&gt;&lt;/script&gt;</code>这行代码删除掉，因为配置了<code>html-webpack-plugin</code>会自动引入打包后的包</p> <p>配置<code>webpack.config.base.js</code>文件，配置输出文件名字，使得生成的包每次生成的名字都不一样，防止浏览器缓存</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.base.js</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 入口</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    App<span class="token operator">:</span> <span class="token string">'./src/index.tsx'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 打包后的动态文件及目录</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'[chunkhash:4][name]bundle.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
      filename<span class="token operator">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span> <span class="token comment">//打包后的文件名</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//webpack.config.dev.js</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> baseWebpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.base.js'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseWebpackConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span> <span class="token comment">// 根目录</span>
    open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    port<span class="token operator">:</span> <span class="token string">'3000'</span><span class="token punctuation">,</span> <span class="token comment">//默认是8080</span>
    stats<span class="token operator">:</span> <span class="token string">'errors-only'</span><span class="token punctuation">,</span> <span class="token comment">//终端仅打印 error</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>在<code>package.json</code>文件添加<code>dev</code>命令<code>dev</code>并运行</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --config webpack.config.dev.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config webpack.config.prod.js&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行<code>yarn dev</code></p> <p>浏览器自动打开<code>http://localhost:3000</code>即项目 html，当我们修改<code>app.tsx</code>文件时，浏览器会自动刷新。</p> <p>在 dev 模式下，我们在<code>dist</code>目录下是看不到任何文件的，因为 dev 把这些文件存放在内存中了</p> <p>执行<code>yarn build</code>进行打包，发现打包出的<code>app.js</code>有<code>343K</code>，webpack提出了警告，后面一小节会来说这个问题</p> <h3 id="_2-3-优化-react-ts-使用体验"><a href="#_2-3-优化-react-ts-使用体验" class="header-anchor">#</a> 2.3 优化 react-ts 使用体验</h3> <ul><li>使用 babel 支持较新的语法</li> <li>在 tsx 中使用 class 组件，使用函数组件</li> <li>在 tsx 中使用 antd</li></ul> <h4 id="_2-3-1-使用较新的语法"><a href="#_2-3-1-使用较新的语法" class="header-anchor">#</a> 2.3.1 使用较新的语法</h4> <p>在 class 组件中，我们可能会用到这些比较新的语法(以下用的 js 语法)</p> <p><a href="https://babeljs.io/docs/en/plugins" target="_blank" rel="noopener noreferrer">babel 的插件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://babeljs.io/docs/en/v7-migration" target="_blank" rel="noopener noreferrer">babel7 的插件包<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// @babel/plugin-proposal-decorators</span>
@<span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">// @babel/plugin-proposal-class-properties</span>
  a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token comment">// 此特性需要安装 babel-plugin-transform-class-properties</span>
  <span class="token comment">// babel7的包名是 @babel/plugin-proposal-class-properties</span>
  <span class="token function-variable function">handleTest</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">12312</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>配置 <code>.babelrc</code>，需要哪些你就可以装哪些，这里我只是用<code>@babel/plugin-proposal-class-properties</code>做一下演示</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-class-properties&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-3-2-在-react-中使用-ts"><a href="#_2-3-2-在-react-中使用-ts" class="header-anchor">#</a> 2.3.2 在 React 中使用 TS</h4> <p>可以去看<a href="https://github.com/xblcity/web-learning/tree/master/webpack-learn/second/src" target="_blank" rel="noopener noreferrer">源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>或者<a href="https://github.com/xblcity/blog/blob/master/react/react-ts.md" target="_blank" rel="noopener noreferrer">前面的这篇文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="_2-3-3-在-react-中使用-ant-design"><a href="#_2-3-3-在-react-中使用-ant-design" class="header-anchor">#</a> 2.3.3 在 React 中使用 ant-design</h4> <div class="language-js extra-class"><pre class="language-js"><code>yarn add antd <span class="token operator">-</span><span class="token constant">S</span>  <span class="token comment">// 不需要安装type库</span>
</code></pre></div><p>但是当我们引入<code>Input Button</code>组件时，发现样式并没有生效，当我们在app.jsx引入<code>import 'antd/dist/antd.css'</code>发现报错了，因为webpack默认只处理<code>src</code>目录下的<code>less</code>文件，我们需要把<code>include</code>包含<code>node_modules</code>，更改配置后发现不报错了，但是还是没有样式效果</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> srcRoot <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> modules <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">)</span>

modules<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|less)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      include<span class="token operator">:</span> <span class="token punctuation">[</span>modules<span class="token punctuation">,</span> srcRoot<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// less-loader要配置 javascriptEnabled: true  开启JS编译</span>
</code></pre></div><p>打包之后发现包竟然变到了<code>1.75M</code>...这个CSS有点太大了吧。。而且还没加载成功。。_</p> <p>antd已经支持动态引入，tree-shaking了，所以说不用再配置<code>babel-plugin-import</code></p> <blockquote><p>https://ant.design/docs/react/introduce-cn
注意：antd 默认支持基于 ES module 的 tree shaking，不使用以下插件也会有按需加载的效果。</p></blockquote> <p>进行打包<code>yarn build</code>，我们发现包的大小从 <code>343K</code> 到了 <code>477K</code> 而我们仅仅引入了两个组件<code>Input Button</code>，如果再增加<code>Rate</code>组件，会变到<code>544K</code> ... 不过要是把antd分离出来，就不是很大。看下面一节</p> <h2 id="_3-优化"><a href="#_3-优化" class="header-anchor">#</a> 3.优化</h2> <blockquote><p>loader 用于帮我们处理不同类型的文件，plugins 用于在打包过程中做优化，在使用它们的时候，我们可以思考一下为什么出现了这些 loader 以及 plugin，它们解决了前端的哪些问题</p></blockquote> <p>开发环境和生产环境的优化可以分离开来</p> <p>我们先按照上一节的内容安装依赖并配置，<a href="https://github.com/xblcity/web-learning/tree/master/webpack-learn/third" target="_blank" rel="noopener noreferrer">源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- extra-class"><pre class="language-text"><code>npm init -y

tsc --init

yarn add webpack webpack-cli css-loader style-loader less less-loader babel-loader @babel/core @babel/preset-env @babel/preset-react url-loader file-loader -D

yarn add react react-dom -S
yarn add @types/react-dom @types/react -D

yarn add typescript @babel/preset-typescript -D

yarn add antd -S 

yarn add webpack-dev-server -D 

yarn add html-webpack-plugin clean-webpack-plugin -D

yarn add cross-env -D // 设置环境变量
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span> dist <span class="token comment">// 用于存放打包后的文件</span>
<span class="token operator">--</span> node_modules <span class="token comment">// 依赖包，自动生成</span>
<span class="token operator">--</span> build
  <span class="token operator">--</span> template
    <span class="token operator">--</span> index<span class="token punctuation">.</span>html
  <span class="token operator">--</span> webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js
<span class="token operator">--</span> <span class="token punctuation">.</span>babelrc <span class="token comment">// babel配置</span>
<span class="token operator">--</span> src
  <span class="token operator">--</span> assets
    <span class="token operator">--</span> avatar<span class="token punctuation">.</span>png
  <span class="token operator">--</span> components
  <span class="token operator">--</span> types <span class="token comment">// 存放声明文件</span>
  <span class="token operator">--</span> index<span class="token punctuation">.</span>tsx
  <span class="token operator">--</span> app<span class="token punctuation">.</span>tsx
  <span class="token operator">--</span> app<span class="token punctuation">.</span>less
<span class="token operator">--</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json
<span class="token operator">--</span> tsconfig<span class="token punctuation">.</span>json
<span class="token operator">--</span> <span class="token punctuation">.</span>gitignore <span class="token comment">// 设置git忽略文件</span>
</code></pre></div><p>编辑<code>tsconfig.json</code>，比如配置react,路径别名等</p> <p>编辑 <code>src</code> 下文件，todoList以及antd等等</p> <p>编辑<code>package.json</code>，添加dev以及build命令</p> <p>编辑build下文件，比如<code>webpack.config.json</code>和对应的rules，以及plugins</p> <p>跟上面一节的内容大致相同，我们在此基础上进行优化，</p> <h4 id="查看依赖"><a href="#查看依赖" class="header-anchor">#</a> 查看依赖</h4> <div class="language-js extra-class"><pre class="language-js"><code>yarn add webpack<span class="token operator">-</span>bundle<span class="token operator">-</span>analyzer <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><blockquote><p>安装依赖并在plugin中配置，用于查看依赖包大小</p></blockquote> <h4 id="css文件优化"><a href="#css文件优化" class="header-anchor">#</a> css文件优化</h4> <p>首先把CSS文件分离出来</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add mini<span class="token operator">-</span>css<span class="token operator">-</span>extract<span class="token operator">-</span>plugin <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><blockquote><p>分别配置loader以及plugin，这里不做赘述</p></blockquote> <h4 id="babel-loader打包速度优化"><a href="#babel-loader打包速度优化" class="header-anchor">#</a> babel-loader打包速度优化</h4> <p>bebel-loader设置缓存</p> <div class="language-js extra-class"><pre class="language-js"><code>use<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token string">'babel-loader?cacheDirectory=true'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="针对包的大小进行优化实践"><a href="#针对包的大小进行优化实践" class="header-anchor">#</a> 针对包的大小进行优化实践</h3> <p>未优化前，DOM加载完毕需要7.5s，这是在GZIP已经开启了的情况下，因为服务器带宽只有1M所以加载比较慢。</p> <p><img src="/assets/img/webpack3_1.d9ad890d.png" alt="webpack"></p> <p>把 antd moment axios 使用 splitChunks 抽离出来(建议用了splitChunks就不要用dellPlugins了)</p> <p>可以看到之前的common已经被分离出antd与vender两个文件</p> <p>但是加载时间基本没有变化</p> <p><img src="/assets/img/webpack3_2.73ff9abd.png" alt="webpack"></p> <p>我们可以看到app.js太大了，加载时间太长了，我们使用webpack-plugin-analyzer进行打包分析。</p> <p><img src="/assets/img/webpack3_3.6ade0229.png" alt="webpack"></p> <p>发现highlight.js和@ant-design的包太大了，antd 只要引用了Icon 其中引用的 @ant-design的包太大了，antd4 icon与 antd是分开的，这里使用antd4优化。</p> <p>并且Icon图标放到CDN上，封装ICON组件用于图标展示</p> <p>还有一部分rc-form的包占用也比较大，因为antd4 form没有引用rc-form，所以包的大小</p> <p>接着我们把react, react-dom, moment, highlightjs这些库全部使用CDN在HTML中引入，并且使用webpack, externals配置全局变量。</p> <div class="language-js extra-class"><pre class="language-js"><code>externals<span class="token operator">:</span> <span class="token punctuation">{</span>
  highlight<span class="token operator">:</span> <span class="token string">'hljs'</span><span class="token punctuation">,</span>
  moment<span class="token operator">:</span> <span class="token string">'moment'</span><span class="token punctuation">,</span>
  react<span class="token operator">:</span> <span class="token string">'React'</span><span class="token punctuation">,</span>
  <span class="token string">'react-dom'</span><span class="token operator">:</span> <span class="token string">'ReactDOM'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>对首页的图片进行压缩</p> <p>做完这些优化之后，首页加载只需要2.3秒，效果还是很明显的</p> <p><img src="/assets/img/webpack3_4.24193a95.png" alt="webpack"></p> <h3 id="其他优化"><a href="#其他优化" class="header-anchor">#</a> 其他优化</h3> <ul><li>为-webkit-等 CSS 属性加上前缀 <a href="https://www.webpackjs.com/loaders/postcss-loader/" target="_blank" rel="noopener noreferrer">postcss-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="_3-43-踩坑"><a href="#_3-43-踩坑" class="header-anchor">#</a> 3.43 踩坑</h3> <p>二级路由加载路径有问题，比如，页面二级路由为<code>admin/add-artilce</code>，webpack 加载的时候，加载的路径是<code>/admin/add-artilce.js</code></p> <p>实际上应该加载的路径是<code>/add-article</code>。在 ouput 设置，<code>publicPath: '/'</code></p> <p>单页面应用，部署到nginx，页面刷新404</p> <div class="language-js extra-class"><pre class="language-js"><code>配置nginx
location <span class="token operator">/</span> <span class="token punctuation">{</span>
  try_files $uri <span class="token operator">/</span>index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://www.webpackjs.com/guides/" target="_blank" rel="noopener noreferrer">webpack 文档指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://webpack.wuhaolin.cn/" target="_blank" rel="noopener noreferrer">深入浅出 Webpack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.jianshu.com/p/dd9037db20f5" target="_blank" rel="noopener noreferrer">从零搭建项目<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/5e5c65fc6fb9a07cd00d8838" target="_blank" rel="noopener noreferrer">深度解锁 Webpack 系列<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">LastEditTime:</span> <span class="time">2020-4-23 10:47:58 ├F10: PM┤</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fe-system/http.html" class="prev">
        http 知识体系
      </a></span> <span class="next"><a href="/fe-engineering/webpack.html">
        webpack 配置及优化
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:30px;bottom:30px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/assets/js/app.68d59ecc.js" defer></script><script src="/assets/js/2.f4862a58.js" defer></script><script src="/assets/js/4.decbb015.js" defer></script>
  </body>
</html>
