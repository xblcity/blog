<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>umi3 升级 | Blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/avatar.png">
    <meta name="description" content="小白龙的前端记录">
    
    <link rel="preload" href="/blog/assets/css/0.styles.2759c791.css" as="style"><link rel="preload" href="/blog/assets/js/app.ca54a27b.js" as="script"><link rel="preload" href="/blog/assets/js/2.16787ae8.js" as="script"><link rel="preload" href="/blog/assets/js/8.03f4b8fb.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.a869079e.js"><link rel="prefetch" href="/blog/assets/js/11.47aba66d.js"><link rel="prefetch" href="/blog/assets/js/12.b2f745c4.js"><link rel="prefetch" href="/blog/assets/js/13.ad8e64be.js"><link rel="prefetch" href="/blog/assets/js/14.19ca1486.js"><link rel="prefetch" href="/blog/assets/js/15.ac5a75b4.js"><link rel="prefetch" href="/blog/assets/js/16.4d3ec439.js"><link rel="prefetch" href="/blog/assets/js/17.4ea1a3ce.js"><link rel="prefetch" href="/blog/assets/js/18.939388da.js"><link rel="prefetch" href="/blog/assets/js/19.6c0ce5fc.js"><link rel="prefetch" href="/blog/assets/js/20.08005603.js"><link rel="prefetch" href="/blog/assets/js/21.44153a61.js"><link rel="prefetch" href="/blog/assets/js/22.034e1f3d.js"><link rel="prefetch" href="/blog/assets/js/23.b7313ad1.js"><link rel="prefetch" href="/blog/assets/js/24.7a561252.js"><link rel="prefetch" href="/blog/assets/js/25.d514c6a3.js"><link rel="prefetch" href="/blog/assets/js/26.0598d777.js"><link rel="prefetch" href="/blog/assets/js/27.3c2daeb6.js"><link rel="prefetch" href="/blog/assets/js/28.abbe705c.js"><link rel="prefetch" href="/blog/assets/js/29.fe0300a3.js"><link rel="prefetch" href="/blog/assets/js/3.120be927.js"><link rel="prefetch" href="/blog/assets/js/30.d7857898.js"><link rel="prefetch" href="/blog/assets/js/31.7e7e8345.js"><link rel="prefetch" href="/blog/assets/js/32.0095b5f6.js"><link rel="prefetch" href="/blog/assets/js/33.c43635e3.js"><link rel="prefetch" href="/blog/assets/js/34.23189405.js"><link rel="prefetch" href="/blog/assets/js/35.32a68e74.js"><link rel="prefetch" href="/blog/assets/js/36.b5522a3b.js"><link rel="prefetch" href="/blog/assets/js/37.521f253a.js"><link rel="prefetch" href="/blog/assets/js/38.d40b50d1.js"><link rel="prefetch" href="/blog/assets/js/39.9866df6a.js"><link rel="prefetch" href="/blog/assets/js/4.6386eb32.js"><link rel="prefetch" href="/blog/assets/js/40.6399e96c.js"><link rel="prefetch" href="/blog/assets/js/41.27f98ed6.js"><link rel="prefetch" href="/blog/assets/js/42.9232dcea.js"><link rel="prefetch" href="/blog/assets/js/43.383a06d4.js"><link rel="prefetch" href="/blog/assets/js/44.bf4ab334.js"><link rel="prefetch" href="/blog/assets/js/45.d39de674.js"><link rel="prefetch" href="/blog/assets/js/46.920f147f.js"><link rel="prefetch" href="/blog/assets/js/47.900f8595.js"><link rel="prefetch" href="/blog/assets/js/48.c3de280b.js"><link rel="prefetch" href="/blog/assets/js/49.56b4130b.js"><link rel="prefetch" href="/blog/assets/js/5.c485396b.js"><link rel="prefetch" href="/blog/assets/js/50.2cda305e.js"><link rel="prefetch" href="/blog/assets/js/51.2c00aa8c.js"><link rel="prefetch" href="/blog/assets/js/52.5d78822c.js"><link rel="prefetch" href="/blog/assets/js/53.a53fe95a.js"><link rel="prefetch" href="/blog/assets/js/54.5760ce51.js"><link rel="prefetch" href="/blog/assets/js/55.1c086e49.js"><link rel="prefetch" href="/blog/assets/js/56.161fc0cb.js"><link rel="prefetch" href="/blog/assets/js/57.a7ecb5a5.js"><link rel="prefetch" href="/blog/assets/js/58.91e85750.js"><link rel="prefetch" href="/blog/assets/js/59.367ed326.js"><link rel="prefetch" href="/blog/assets/js/6.b879935f.js"><link rel="prefetch" href="/blog/assets/js/60.2f10a9f8.js"><link rel="prefetch" href="/blog/assets/js/61.de5d0fa6.js"><link rel="prefetch" href="/blog/assets/js/62.587e2766.js"><link rel="prefetch" href="/blog/assets/js/63.7f394d4d.js"><link rel="prefetch" href="/blog/assets/js/64.3c55b83e.js"><link rel="prefetch" href="/blog/assets/js/65.4f73d851.js"><link rel="prefetch" href="/blog/assets/js/66.2edb0511.js"><link rel="prefetch" href="/blog/assets/js/67.deca57c5.js"><link rel="prefetch" href="/blog/assets/js/68.35918e5c.js"><link rel="prefetch" href="/blog/assets/js/69.1d25bf4f.js"><link rel="prefetch" href="/blog/assets/js/7.bde98456.js"><link rel="prefetch" href="/blog/assets/js/70.6685b325.js"><link rel="prefetch" href="/blog/assets/js/71.c476a8fb.js"><link rel="prefetch" href="/blog/assets/js/72.5407e0cc.js"><link rel="prefetch" href="/blog/assets/js/73.5b5f66ab.js"><link rel="prefetch" href="/blog/assets/js/74.5dbe1de3.js"><link rel="prefetch" href="/blog/assets/js/75.05b3ae2a.js"><link rel="prefetch" href="/blog/assets/js/76.6cb0c66a.js"><link rel="prefetch" href="/blog/assets/js/77.5246a44f.js"><link rel="prefetch" href="/blog/assets/js/78.a2e9acd1.js"><link rel="prefetch" href="/blog/assets/js/9.cc85d3f5.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.2759c791.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/avatar.png" alt="Blog" class="logo"> <span class="site-name can-hide">Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://xblcity.github.io/reading-notes/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  读书笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/xblcity" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://xblcity.github.io/reading-notes/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  读书笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/xblcity" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/" aria-current="page" class="sidebar-link">介绍</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/base/inherit.html" class="sidebar-link">类与继承</a></li><li><a href="/blog/base/copy.html" class="sidebar-link">赋值与深浅拷贝</a></li><li><a href="/blog/base/scope-closures.html" class="sidebar-link">作用域与闭包</a></li><li><a href="/blog/base/this.html" class="sidebar-link">理解this</a></li><li><a href="/blog/base/call.html" class="sidebar-link">call, apply, bind手动实现</a></li><li><a href="/blog/base/eventloop.html" class="sidebar-link">JS 事件队列/循环(Event Loop)</a></li><li><a href="/blog/base/ajax.html" class="sidebar-link">AJAX</a></li><li><a href="/blog/base/throttle.html" class="sidebar-link">理解节流与防抖函数</a></li><li><a href="/blog/base/object-methods.html" class="sidebar-link">Object 构造器及原型上的方法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/advance/ts.html" class="sidebar-link">开发中常用的 Typescript 技巧</a></li><li><a href="/blog/advance/func-program.html" class="sidebar-link">高阶函数</a></li><li><a href="/blog/advance/design-mode.html" class="sidebar-link">JS 设计模式</a></li><li><a href="/blog/advance/algorithm.html" class="sidebar-link">数据结构与算法</a></li><li><a href="/blog/advance/array.html" class="sidebar-link">数组的数据处理</a></li><li><a href="/blog/advance/lodashSource.html" class="sidebar-link">lodash omit</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>React应用</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/react/performance.html" class="sidebar-link">React 性能优化</a></li><li><a href="/blog/react/lifecycle.html" class="sidebar-link">React 生命周期总结&amp;应用</a></li><li><a href="/blog/react/redux.html" class="sidebar-link">Redux/React-Redux</a></li><li><a href="/blog/react/redux-middleware.html" class="sidebar-link">Redux 中间件</a></li><li><a href="/blog/react/encrypt-images.html" class="sidebar-link">加密图片获取</a></li><li><a href="/blog/react/picker.html" class="sidebar-link">Picker 组件</a></li><li><a href="/blog/react/swiper.html" class="sidebar-link">Swiper插件踩坑</a></li><li><a href="/blog/react/find-house.html" class="sidebar-link">找房筛选条件表单封装</a></li><li><a href="/blog/react/umi3.html" aria-current="page" class="active sidebar-link">umi3 升级</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#修改相关配置" class="sidebar-link">修改相关配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#package-json" class="sidebar-link">package.json</a></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#tsconfig-json" class="sidebar-link">tsconfig.json</a></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#config-config-local-js" class="sidebar-link">config/config.local.js</a></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#config-config-prod-js" class="sidebar-link">config/config.prod.js</a></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#config-config-js" class="sidebar-link">config/config.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#代码层" class="sidebar-link">代码层</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#import-all-from-umi" class="sidebar-link">import all from umi</a></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#umi-router" class="sidebar-link">umi/router</a></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#formatmessage" class="sidebar-link">formatMessage</a></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#删除-src-umi-执行-yarn-start" class="sidebar-link">删除 src/.umi 执行 yarn start</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#问题" class="sidebar-link">问题</a></li><li class="sidebar-sub-header"><a href="/blog/react/umi3.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/blog/react/component-design-mode.html" class="sidebar-link">组件设计模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端综合知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/system/performance.html" class="sidebar-link">性能优化</a></li><li><a href="/blog/system/render.html" class="sidebar-link">从输入网址到页面渲染经历了什么</a></li><li><a href="/blog/system/http.html" class="sidebar-link">http 知识体系</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/engineering/c-project.html" class="sidebar-link">C端Next.js项目踩坑</a></li><li><a href="/blog/engineering/webpack-react.html" class="sidebar-link">使用 webpack 从零配置 React 开发环境及打包优化</a></li><li><a href="/blog/engineering/webpack.html" class="sidebar-link">webpack 配置及优化</a></li><li><a href="/blog/engineering/vs.html" class="sidebar-link">vscode 插件与配置</a></li><li><a href="/blog/engineering/git.html" class="sidebar-link">git 的使用</a></li><li><a href="/blog/engineering/git-account.html" class="sidebar-link">Git 多账号配置</a></li><li><a href="/blog/engineering/private-npm.html" class="sidebar-link">windows 系统搭建私有 npm 仓库</a></li><li><a href="/blog/engineering/workflow.html" class="sidebar-link">前端从切分支到打包上线的流程整理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>后端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/backend/file.html" class="sidebar-link">Next.js Node 层上传/接收文件流</a></li><li><a href="/blog/backend/little-points.html" class="sidebar-link">node 知识点</a></li><li><a href="/blog/backend/blog.html" class="sidebar-link">博客的后端实现</a></li><li><a href="/blog/backend/mysql.html" class="sidebar-link">mysql 使用</a></li><li><a href="/blog/backend/server.html" class="sidebar-link">使用服务器</a></li><li><a href="/blog/backend/nginx.html" class="sidebar-link">nginx 在 window 下的配置与使用</a></li><li><a href="/blog/backend/ubuntu.html" class="sidebar-link">ubuntu服务器终端及图形界面连接</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第三方库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/library/wx-web.html" class="sidebar-link">微信公众号网页登录与支付</a></li><li><a href="/blog/library/vue-admin.html" class="sidebar-link">vue-element-admin 的使用</a></li><li><a href="/blog/library/vuepress.html" class="sidebar-link">vuepress 一些自定义配置</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="umi3-升级"><a href="#umi3-升级" class="header-anchor">#</a> umi3 升级</h1> <h2 id="修改相关配置"><a href="#修改相关配置" class="header-anchor">#</a> 修改相关配置</h2> <h3 id="package-json"><a href="#package-json" class="header-anchor">#</a> package.json</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token string-property property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>

<span class="token operator">-</span>  <span class="token string">&quot;umi&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.13.0&quot;</span>

<span class="token operator">+</span>  <span class="token string">&quot;umi&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.2.19&quot;</span>

<span class="token operator">-</span>  <span class="token string">&quot;umi-plugin-react&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.15.6&quot;</span>

<span class="token operator">+</span>  <span class="token string">&quot;@umijs/preset-react&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.6.4&quot;</span>

<span class="token punctuation">}</span>

<span class="token string-property property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>

<span class="token operator">-</span>  <span class="token string">&quot;dva&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.4.0&quot;</span>

<span class="token punctuation">}</span>

</code></pre></div><h3 id="tsconfig-json"><a href="#tsconfig-json" class="header-anchor">#</a> tsconfig.json</h3> <p>增加@@别名，支持更好的 ts 提示</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>

 <span class="token string-property property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>

    <span class="token string-property property">&quot;@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./src/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

 <span class="token operator">+</span> <span class="token string">&quot;@@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./src/.umi/*&quot;</span><span class="token punctuation">]</span>

 <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre></div><h3 id="config-config-local-js"><a href="#config-config-local-js" class="header-anchor">#</a> config/config.local.js</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token punctuation">{</span>

 <span class="token operator">-</span> history<span class="token operator">:</span> <span class="token string">'hash'</span>

 <span class="token operator">+</span> history<span class="token operator">:</span> <span class="token punctuation">{</span>

 <span class="token operator">+</span>  type<span class="token operator">:</span> <span class="token string">'hash'</span><span class="token punctuation">,</span>

 <span class="token operator">+</span> <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre></div><h3 id="config-config-prod-js"><a href="#config-config-prod-js" class="header-anchor">#</a> config/config.prod.js</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token punctuation">{</span>

 <span class="token operator">-</span> history<span class="token operator">:</span> <span class="token string">'browser'</span>

 <span class="token operator">+</span> history<span class="token operator">:</span> <span class="token punctuation">{</span>

 <span class="token operator">+</span>  type<span class="token operator">:</span> <span class="token string">'browser'</span><span class="token punctuation">,</span>

 <span class="token operator">+</span> <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre></div><h3 id="config-config-js"><a href="#config-config-js" class="header-anchor">#</a> config/config.js</h3> <h4 id="plugin-配置拍平"><a href="#plugin-配置拍平" class="header-anchor">#</a> plugin 配置拍平</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;umi-plugin-react&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">antd</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dva</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">hmr</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">targets</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">ie</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">locale</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">antd</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token literal-property property">enable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// default false</span>
          <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&quot;zh-CN&quot;</span><span class="token punctuation">,</span> <span class="token comment">// default zh-CN</span>
          <span class="token comment">// default true, when it is true, will use `navigator.language` overwrite default</span>
          <span class="token literal-property property">baseNavigator</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dynamicImport</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">loadingComponent</span><span class="token operator">:</span> <span class="token string">&quot;/containers/ProgressLine&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>改成如下格式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">antd</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dva</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">hmr</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">locale</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// antd: true,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&quot;zh-CN&quot;</span><span class="token punctuation">,</span> <span class="token comment">// default zh-CN</span>
    <span class="token comment">// default true, when it is true, will use `navigator.language` overwrite default</span>
    <span class="token literal-property property">baseNavigator</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dynamicImport</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">loading</span><span class="token operator">:</span> <span class="token string">&quot;@/containers/ProgressLine&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>修改 antd，locale 配置</li> <li>dva 配置不变</li> <li>删除 targets，与原本 umi 配置 targets 重合了</li> <li>dynamicImport 内置为 umi 配置，并且需要修改引用路径</li></ul> <h4 id="其余配置"><a href="#其余配置" class="header-anchor">#</a> 其余配置</h4> <ul><li>删除 disableRedirectHoist</li> <li>删除 manifest，原来的配置与 umi2/3 不吻合</li> <li>删除 layout 配置，在 umi2 并未找到此配置（在 umi3 如果使用此配置，需要额外安装 <code>@ant-design/pro-layout</code> 配合 <code>@umijs/plugin-layout</code> 插件使用，可能会出问题）</li> <li>lessLoaderOptions 命名为 lessLoader</li> <li>cssLoaderOptions 命名为 cssLoader，并修改 getLocalIdent 选项，不修改会产生样式名解析错误，导致样式错乱</li></ul> <p><img src="/blog/assets/img/Snipaste_2020-09-18_10-01-06.c75d6602.png" alt="样式名错误"></p> <p><img src="/blog/assets/img/Snipaste_2020-09-18_10-08-36.1f308289.png" alt="样式名正确处理"></p> <p>完整配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// https://umijs.org/config/</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> utils <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;umi&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> pageRoutes <span class="token keyword">from</span> <span class="token string">&quot;./router.config&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> webpackPlugin <span class="token keyword">from</span> <span class="token string">&quot;./plugin.config&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> setting <span class="token keyword">from</span> <span class="token string">&quot;../src/defaultSettings&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> winPath <span class="token punctuation">}</span> <span class="token operator">=</span> utils<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">antd</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dva</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">hmr</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">locale</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// antd: true,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&quot;zh-CN&quot;</span><span class="token punctuation">,</span> <span class="token comment">// default zh-CN</span>
    <span class="token comment">// default true, when it is true, will use `navigator.language` overwrite default</span>
    <span class="token literal-property property">baseNavigator</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dynamicImport</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">loading</span><span class="token operator">:</span> <span class="token string">&quot;@/containers/ProgressLine&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">targets</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ie</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 路由配置</span>
  <span class="token literal-property property">routes</span><span class="token operator">:</span> pageRoutes<span class="token punctuation">,</span>
  <span class="token comment">// Theme for antd</span>
  <span class="token comment">// https://ant.design/docs/react/customize-theme-cn</span>
  <span class="token literal-property property">theme</span><span class="token operator">:</span> setting<span class="token punctuation">.</span>themeVars<span class="token punctuation">,</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;@antv/data-set&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DataSet&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">moment</span><span class="token operator">:</span> <span class="token string">&quot;moment&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">jquery</span><span class="token operator">:</span> <span class="token string">&quot;$&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mockjs</span><span class="token operator">:</span> <span class="token string">&quot;Mock&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;uuid/v4&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uuidv4&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ignoreMomentLocale</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">lessLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">javascriptEnabled</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cssLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">getLocalIdent</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> localIdentName<span class="token punctuation">,</span> localName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>
          context<span class="token punctuation">.</span>resourcePath<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span>
          context<span class="token punctuation">.</span>resourcePath<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;ant.design.pro.less&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span>
          context<span class="token punctuation">.</span>resourcePath<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;global.less&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> localName<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> match <span class="token operator">=</span> context<span class="token punctuation">.</span>resourcePath<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">src(.*)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>match <span class="token operator">&amp;&amp;</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> antdProPath <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.less&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token function">winPath</span><span class="token punctuation">(</span>antdProPath<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([A-Z])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;-$1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">antd-pro</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>localName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">--</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> localName<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">chainWebpack</span><span class="token operator">:</span> webpackPlugin<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="代码层"><a href="#代码层" class="header-anchor">#</a> 代码层</h2> <h3 id="import-all-from-umi"><a href="#import-all-from-umi" class="header-anchor">#</a> import all from umi</h3> <p>不再保留 umi/xxx 的接口，全部从 umi 中 import。</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token operator">-</span> <span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'umi/link'</span><span class="token punctuation">;</span>

<span class="token operator">+</span> <span class="token keyword">import</span> <span class="token punctuation">{</span> Link <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'umi'</span><span class="token punctuation">;</span>

<span class="token operator">-</span> <span class="token keyword">import</span> withRouter <span class="token keyword">from</span> <span class="token string">'umi/withRouter'</span><span class="token punctuation">;</span>

<span class="token operator">+</span> <span class="token keyword">import</span> <span class="token punctuation">{</span> withRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'umi'</span><span class="token punctuation">;</span>

<span class="token operator">-</span> <span class="token keyword">import</span> <span class="token punctuation">{</span> formatMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'umi/locale'</span><span class="token punctuation">;</span>

<span class="token operator">+</span> <span class="token keyword">import</span> <span class="token punctuation">{</span> formatMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'umi'</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="umi-router"><a href="#umi-router" class="header-anchor">#</a> umi/router</h3> <p>改用 history 代替。</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token operator">-</span> <span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'umi/router'</span><span class="token punctuation">;</span>

<span class="token operator">+</span> <span class="token keyword">import</span> <span class="token punctuation">{</span> history <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'umi'</span><span class="token punctuation">;</span>

<span class="token operator">-</span> router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">+</span> history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="formatmessage"><a href="#formatmessage" class="header-anchor">#</a> formatMessage</h3> <p>继续使用 formatMessage 控制台会报警告，在切换语言的时候无法自动刷新</p> <p>项目暂时没有用到该特性 <code>SelectLang/index.js</code></p> <p><img src="data:image/png;base64,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" alt="警告信息"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useIntl <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;umi&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> intl <span class="token operator">=</span> <span class="token function">useIntl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>intl<span class="token punctuation">.</span><span class="token function">formatMessage</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">defaultMessage</span><span class="token operator">:</span> <span class="token string">&quot;你好，旅行者&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;旅行者&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> injectIntl<span class="token punctuation">,</span> FormattedRelative <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-intl&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">to2Digits</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>num <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">0</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>num<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> num<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">RelativeTime</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> date<span class="token punctuation">,</span> intl <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> year <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> month <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> day <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> formattedDate <span class="token operator">=</span> intl<span class="token punctuation">.</span><span class="token function">formatDate</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">year</span><span class="token operator">:</span> <span class="token string">&quot;long&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">month</span><span class="token operator">:</span> <span class="token string">&quot;numeric&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">day</span><span class="token operator">:</span> <span class="token string">&quot;numeric&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>time
      dateTime<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>year<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">to2Digits</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">to2Digits</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span>
      title<span class="token operator">=</span><span class="token punctuation">{</span>formattedDate<span class="token punctuation">}</span>
    <span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FormattedRelative value<span class="token operator">=</span><span class="token punctuation">{</span>date<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>time<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">injectIntl</span><span class="token punctuation">(</span>RelativeTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="删除-src-umi-执行-yarn-start"><a href="#删除-src-umi-执行-yarn-start" class="header-anchor">#</a> 删除 src/.umi 执行 yarn start</h3> <p>另外，umi3 项目启动后不会自动打开浏览器</p> <h2 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h2> <p>ant 组件部分样式没有加载成功（这个问题有的电脑出现，有的没出现？）</p> <p><img src="/blog/assets/img/Snipaste_2020-09-18_14-44-50.8e638b03.png" alt="部分样式未加载成功"></p> <p>如果出现了，下面的解决方法可以参考：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">-</span> @<span class="token keyword">import</span> <span class="token string">'~antd/lib/style/themes/default.less'</span><span class="token punctuation">;</span>
<span class="token operator">+</span> @<span class="token keyword">import</span> <span class="token string">'~antd/dist/antd.less'</span><span class="token punctuation">;</span>
</code></pre></div><p>比如：添加之前在运行文件 <code>umi.js</code> 中未发现 <code>ant-list-items</code>，修改后可以找到，且包大小未发生变化。</p> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://umijs.org/zh-CN/docs/upgrade-to-umi-3" target="_blank" rel="noopener noreferrer">升级到 umi3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://umijs.org/zh-CN/guide/upgrade-antd-pro-to-umi-3" target="_blank" rel="noopener noreferrer">升级 antd pro 项目到 umi@3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/umijs/plugins/tree/d0d70cc811df398ec8794476b33a4b6a0913c064/packages/plugin-locale#useintl" target="_blank" rel="noopener noreferrer">useIntl<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://formatjs.io/docs/react-intl/upgrade-guide-2x/#update-to-injectintl" target="_blank" rel="noopener noreferrer">Update to injectIntl()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">LastEditTime:</span> <span class="time">2022/2/25 10:48:36</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/react/find-house.html" class="prev">
        找房筛选条件表单封装
      </a></span> <span class="next"><a href="/blog/react/component-design-mode.html">
        组件设计模式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:30px;bottom:30px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/blog/assets/js/app.ca54a27b.js" defer></script><script src="/blog/assets/js/2.16787ae8.js" defer></script><script src="/blog/assets/js/8.03f4b8fb.js" defer></script>
  </body>
</html>
